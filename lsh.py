from datetime import datetime
import math
from pyspark.sql import SparkSession
import findspark
from datasketch import MinHashLSHEnsemble, MinHash


res = ['184156925', '184426907', '184466236', '170591903', '175844813', '175844880', '175844917', '170592113', '170592378', '170592168', '170592076', '184085074', '184328000', '184387955', '175844852', '170592498', '184386655', '170592133', '184197944', '184457270', '175845061', '170591925', '184132797', '175844827', '170592222', '184381350', '184209595', '183386649', '184227004', '170592379', '170592416', '184193351', '184190654', '170591907', '170592050', '184109079', '170592100', '184544744', '184124146', '170592249', '184248033', '170592248', '184566543', '170592318', '170592127', '184238192', '170592518', '184475655', '170592540', '175845092', '175844718', '170592486', '170592329', '170592077', '184441834', '170592440', '170592497', '170592316', '184329202', '175844750', '184414198', '184333586', '184212822', '184015784', '170592417', '170592328', '184240714', '175844954', '184424770', '170592195', '171716050', '184351761', '170592436', '184089321', '175845073', '184219370', '184427222', '170592188', '184293590', '170592419', '184469199', '183993364', '184079201', '184110356', '184055338', '184631189', '170591945', '175844887', '175844907', '184468069', '175845075', '170592470', '170592533', '175844984', '184411362', '184144440', '184511493', '170592002', '184143179', '170592018', '184209309', '170592345', '184391591', '184552239', '170592223', '175844730', '184238466', '175844941', '184554775', '184215784', '184342072', '175844935', '170592359', '175845054', '170592381', '184311578', '184457542', '175844760', '175845004', '184150110', '175845024', '170592467', '184344585', '170592106', '184231259', '170592527', '170592273', '184568263', '184532507', '184302546', '170592340', '170592119', '184459067', '184083043', '184506285', '170591942', '184470446', '184603082', '184108436', '175845063', '170591946', '170592027', '172289979', '170592087', '184325017', '170591928', '170592060', '170592400', '184142152', '170592439', '184065409', '170591935', '184567887', '184459035', '184464761', '184083921', '175844696', '175844797', '184548513', '184434410', '184635109', '170592189', '184123200', '184366857', '170592262', '175845072', '170592502', '170592012', '183969987', '170592210', '184446002', '170592353', '175844882', '175844950', '184526709', '175844772', '170592066', '170592311', '170592251', '184420897', '175844713', '175844788', '170592490', '175844860', '170592072', '184408993', '184209737', '170592343', '175844774', '184232319', '184307269', '170592177', '184368081', '184363857', '175845041', '170592477', '175844998', '184343765', '170592145', '184419524', '184340990', '170592212', '183476533', '170592369', '184374596', '170592059', '170592480', '170592230', '175845038', '184560311', '184207249', '184534588', '184413500', '184021016', '170592395', '184470157', '170591993', '170592319', '184342525', '175844829', '170592117', '175844758', '170592387', '170592255', '184190978', '184491472', '184533744', '175844832', '184412716', '170592214', '184192438', '184410311', '184395089', '170592164', '175844867', '184456492', '170592525', '170592268', '184565696', '175844891', '183968989', '175844711', '184046503', '175844976', '170592404', '184168475', '184172573', '184366920', '184154711', '170592159', '184185551', '170592555', '184395164', '184144215', '184261207', '175844989', '170592049', '175844838', '175844828', '170592001', '175844939', '184061755', '184117006', '170592298', '184517409', '170591962', '184125936', '184294816', '184215098', '183363034', '184073131', '184069319', '183939509', '170591943', '170592085', '170591954', '184559575', '184433862', '170592045', '184164222', '170592078', '170592544', '170592161', '170592326', '170592244', '170592010', '170592310', '170592267', '184330885', '175845097', '184429921', '175844825', '170592197', '170592294', '170592003', '184527095', '170592061', '184344535', '175844741', '184218767', '184150084', '175844934', '175845010', '175844931', '175845031', '175845084', '175844969', '175845081', '184387991', '184510586', '184184233', '184074699', '170591944', '184553862', '170592187', '170592426', '170592130', '184146873', '184400704', '170592334', '184361619', '170592132', '183066700', '184140180', '184189957', '170592557', '170592170', '183135896', '170592180', '184441662', '170592005', '184300684', '184098873', '184207563', '183963329', '184427545', '170592501', '170592412', '184561220', '175844686', '184125809', '184110499', '170592284', '184281394', '170592031', '184155516', '170592068', '170592394', '170591909', '184197618', '170592427', '183934152', '184163036', '170592258', '170592091', '170592147', '175844851', '175845025', '175845076', '184585492', '184546642', '170592137', '184543744', '175844895', '170592392', '170592017', '184203607', '170591960', '184087335', '184061762', '184233570', '184229266', '170592457', '170592101', '184483694', '184332516', '175845037', '184460080', '184473079', '184511222', '175844929', '184517354', '175844876', '175844820', '184096848', '175844953', '184393737', '184424831', '170591948', '184274458', '184210640', '170592534', '175844798', '184248952', '170592245', '170592424', '175844926', '175844705', '184416119', '170592468', '170592282', '184139793', '184406713', '170592259', '170592407', '175844945', '184345568', '184257233', '184060263', '184539473', '170592476', '184526575', '170592096', '175844978', '170592402', '183343925', '184093155', '175844746', '184154098', '170592201', '184361272', '170592098', '184126958', '170592354', '175844780', '170591986', '175844729', '170592415', '175844961', '170592399', '184039595', '175844771', '184520637', '170592422', '170592192', '170592013', '184544995', '175845059', '175845067', '170592178', '170591902', '184382472', '170591926', '184439448', '170591915', '184211061', '184416940', '184255391', '184461055', '184196296', '175844856', '184316732', '170592293', '184214066', '184196215', '170592425', '184567172', '175844722', '184420723', '175844717', '170591996', '175844952', '184507874', '175844877', '184109242', '184174800', '170592385', '170592073', '184067068', '175844896', '170592327', '184168867', '170592065', '184506987', '170592434', '170592084', '170592148', '170592314', '170592453', '175845026', '175844830', '184132262', '184369489', '184411781', '184518340', '170592185', '184351937', '184411772', '184444821', '184595662', '184265064', '170592199', '184383817', '184368205', '175845036', '184204853', '184289080', '184410964', '184580305', '170592055', '175844928', '184420020', '184021186', '184285265', '170592312', '170592493', '175845105', '170592386', '184448818', '175844845', '184344060', '175844915', '184631376', '184362372', '184167163', '184244511', '183461499', '184533281', '170591906', '170591979', '184357071', '175845019', '183911343', '183432136', '184486253', '184320104', '184271583', '184388340', '175845051', '170592333', '175844946', '184195967', '170592140', '184423604', '184165219', '170592226', '182488445', '175844699', '170592165', '170592299', '170592393', '170592280', '170592090', '184428711', '184144123', '184367177', '170592150', '184498981', '184490588', '184246368', '175845035', '184400321', '175845020', '184517382', '170592548', '170592403', '170592460', '170592358', '184550586', '170592352', '170592330', '170592366', '184325598', '184109702', '170591999', '184130578', '175844698', '175844809', '184257486', '170592107', '170592499', '184055472', '170592128', '184568215', '170592028', '170592193', '184157901', '170592239', '184163340', '175844944', '170592438', '170592349', '184219337', '183969226', '170592046', '170592487', '184352412', '175844841', '184450223', '175844901', '184071210', '175844884', '184550690', '184357030', '184108666', '170592163', '170592538', '170592220', '175844728', '175845006', '170592452', '184077608', '184153556', '184432754', '175844816', '170592094', '175844878', '184412035', '184517769', '170592234', '175845022', '175844963', '184071057', '184080735', '170592129', '175844693', '184431637', '175844787', '175844752', '175844779', '184091574', '184193505', '175844977', '175844836', '184137196', '184165232', '184320124', '184393314', '175845100', '175844743', '184235386', '182944798', '184164136', '184171965', '184027220', '175845093', '170592361', '175844823', '170591974', '170592442', '170592371', '184398596', '184540334', '184271031', '175844904', '184491488', '184209732', '184589073', '175844833', '175844991', '170592030', '170592364', '170592229', '184236516', '170592408', '170591952', '175844765', '175844886', '170592079', '175844897', '183872510', '184421651', '170592514', '184455881', '170592535', '184047285', '184448421', '170591901', '184015493', '184199628', '184220066', '184440855', '184205355', '170592238', '184380849', '184411762', '184151181', '184215647', '184129427', '183993984', '170592546', '184192665', '184528714', '170592511', '184005803', '184542278', '184077122', '170592051', '175844840', '170592253', '184507617', '175844898', '170592418', '175845080', '175844764', '170592356', '175844769', '184558649', '175844910', '175844794', '175844844', '170592213', '184363553', '183469019', '175844864', '184372219', '170592376', '170592075', '175844870', '184525848', '184450391', '184256814', '175845001', '170592219', '170592309', '184546560', '170592532', '184131013', '184352093', '170592342', '175844757', '184466903', '170591917', '170592173', '184437601', '184416213', '184198376', '184546094', '170591908', '170592324', '170591963', '170592275', '184376189', '184442921', '184502810', '183538372', '175844720', '170592545', '184208362', '170592026', '184390817', '183940670', '170592406', '184414371', '170592474', '184055762', '184351608', '175845040', '175845099', '183645431', '183914553', '184100489', '175845074', '175844868', '184282597', '175844905', '183057616', '184532684', '184482361', '184531432', '184399106', '170591921', '184190476', '184442117', '170592350', '184065556', '170592504', '184522472', '184039823', '175844893', '184473881', '170592510', '175844908', '170592289', '175844802', '184217811', '184396984', '170592435', '184034088', '184397762', '184169624', '184516260', '170592323', '184363339', '184138057', '170591966', '175844702', '170592410', '183828757', '175844745', '175844937', '175844785', '175845085', '184115494', '184305330', '175844966', '184036522', '170592209', '183349394', '184030975', '184448765', '184515506', '175845086', '184538961', '184550017', '184184743', '183953862', '170592320', '184078567', '183527851', '184521299', '184480951', '170592256', '184163677', '175844792', '175844938', '184186765', '184444535', '175844726', '175844957', '184523044', '175844695', '170592397', '184194144', '184392191', '184147731', '170592025', '175844754', '184240570', '184142246', '184590687', '184523748', '184460925', '184534756', '184193013', '175844843', '170592491', '170592500', '175844948', '184469044', '175845053', '184485542', '184201230', '184191992', '184061473', '170592285', '170591951', '170592166', '170591988', '184326075', '184097805', '170591969', '184167751', '184612508', '170592509', '170591904', '184447938', '184269618', '184380332', '170592198', '175844980', '184216851', '184297137', '170591914', '184341436', '184082540', '184196773', '184412078', '170591990', '175844992', '175844956', '170591998', '170592042', '170592053', '183998914', '184029145', '170591920', '170592083', '170592118', '184522672', '184047942', '183962092', '184235153', '184400880', '170591983', '170592367', '184067511', '175845008', '170592039', '170592372', '184171664', '184053455', '175844942', '170592459', '184525634', '184258833', '170591971', '184379087', '170592086', '170592056', '184518373', '184555244', '175844874', '183896502', '184198402', '175844789', '170592114', '184162524', '184502345', '170592388', '184071781', '183932108', '184470645', '184168335', '184517062', '175844973', '184021171', '170592396', '175844795', '175844866', '184533119', '175844739', '183897348', '170591953', '170592263', '170592355', '184296414', '175844873', '184432409', '184398738', '175845013', '184417036', '175844892', '184351128', '170592032', '184541490', '184164696', '184484348', '184168243', '170592122', '184374829', '170592331', '184365046', '175845021', '170591959', '184061236', '184329473', '170591924', '170592151', '184151456', '184120487', '184537294', '170592271', '184422464', '175844972', '175844999', '182758750', '175844773', '175845055', '170592067', '175845017', '175844715', '170591940', '170591919', '175844922', '184408730', '175845083', '170592380', '175844736', '184055558', '175845030', '184133117', '175845044', '175844857', '184195149', '184632705', '184109028', '184176434', '175845046', '184500590', '175845078', '170591987', '170592082', '170591949', '170592011', '184190658', '184226986', '184347245', '170592503', '184433557', '170592469', '184442239', '184467414', '170592225', '170592559', '170592420', '176414245', '170592044', '170592167', '170592506', '170592152', '175844766', '184106185', '175844790', '175844781', '184385970', '184566250', '170592346', '175844819', '175844949', '184547330', '175845098', '170592196', '170592513', '170591995', '184454543', '170592290', '183994374', '175844692', '184253017', '184278530', '184523340', '170592169', '184216697', '175844719', '175845049', '175844723', '175845057', '184523169', '184181333', '170592549', '184190163', '170592054', '184034089', '184520851', '170591905', '170591997', '184453112', '170592266', '184271081', '184412680', '170592383', '170591922', '175844826', '184213668', '175844767', '175844793', '184591584', '184110440', '184367671', '170592471', '170592537', '170592048', '184514106', '184308726', '175844700', '170592411', '184149791', '184562404', '170591913', '170592218', '175845011', '184515654', '175844869', '184301439', '170591910', '170591900', '170592109', '170592080', '170592556', '183286063', '184572900', '175844685', '184377889', '170592203', '170592302', '170592231', '184168455', '184181149', '170592496', '175844965', '170592235', '170591918', '175844916', '170592443', '184465397', '170592463', '170592550', '170592365', '170592530', '175844994', '175844799', '184436647', '175844883', '175845082', '175844703', '170592465', '184474200', '184330493', '184171053', '170592475', '184270332', '175844865', '184111320', '184227653', '184250379', '184179148', '170592322', '170592254', '175845108', '175844687', '184179128', '175845066', '184231189', '170592216', '184119236', '184381766', '170592296', '170592307', '170592377', '170592291', '170592539', '175844814', '175844912', '170592495', '184541364', '184095039', '170592136', '175844854', '175844959', '170591968', '184638036', '184491991', '170591981', '184434966', '170592221', '184182768', '184205760', '175844712', '170592204', '184191106', '184532459', '175844776', '184172057', '184613357', '184247695', '183625605', '170592000', '175844721', '184532286', '175844846', '170592348', '184143554', '170592300', '175844925', '184385174', '170592339', '175844971', '175844881', '184238127', '170592389', '184446302', '175844918', '184000067', '170592288', '184340099', '183652762', '184543878', '184494867', '184514933', '170591938', '170592033', '175844759', '175845062', '170592200', '175844920', '184512716', '170592175', '170592015', '175844863', '170591964', '184260837', '175844960', '183921117', '184065031', '170592215', '175844967', '170591936', '170592441', '175844691', '184519633', '184146665', '170591991', '184344642', '184031238', '170592479', '170592363', '184059007', '183371659', '184197017', '175844933', '184013444', '175844923', '184508843', '170591961', '170591898', '184324801', '184082254', '170592261', '170592473', '184120216', '170591896', '184131843', '184544690', '170592325', '170591956', '184249852', '184412931', '175844747', '170591934', '184362273', '170592134', '170592494', '184537547', '170591916', '184342067', '184238356', '184188626', '184469104', '184541368', '170591939', '170591992', '171990528', '184150509', '175844988', '175844871', '170591931', '170592237', '175844850', '184146920', '184353437', '184220092', '172461994', '170592265', '184437920', '170591965', '184405545', '184501739', '170592375', '184399556', '170591930', '170592524', '175844805', '175845079', '184331591', '184422151', '184255424', '184059992', '184388401', '175844983', '183861295', '184557657', '184532316', '184037192', '170592529', '175844835', '175844784', '170592413', '184120060', '170592183', '170592283', '175845003', '184305122', '184110101', '184350233', '184387761', '184569922', '170592317', '170592179', '175844859', '175844936', '184446307', '175845069', '175844981', '183622182', '184271187', '175845002', '170592191', '170592242', '175844837', '183089736', '184155455', '184295729', '184101385', '175844930', '175844975', '184447488', '184483846', '170592202', '175844888', '175844808', '184456466', '170592528', '170592041', '170592172', '184406135', '170592108', '175844875', '170592074', '184530758', '184635777', '184152476', '184016707', '184432442', '184391798', '184594286', '175844783', '170592121', '170592360', '175844688', '183936363', '170591947', '170592542', '184150101', '184499966', '184444554', '175845106', '175844849', '170592093', '184187924', '184159747', '184411860', '184484913', '184510782', '175845016', '170592552', '170592023', '175844995', '170592341', '175844879', '184132114', '184479694', '184565716', '175844744', '170592450', '170592104', '175844748', '170592089', '170592448', '170592466', '184311887', '170592125', '184465659', '184173530', '170592414', '170592124', '184137480', '170592110', '175844894', '175844899', '175844902', '184166685', '184462143', '184534388', '170592081', '184151846', '170592430', '184171482', '170592247', '184420011', '170592008', '184129008', '184459200', '175845012', '170592171', '170592484', '170591929', '170592304', '184335031', '170592154', '184503089', '170592488', '170592260', '184504371', '184503733', '175844872', '184474682', '170592547', '175844947', '175844740', '184141236', '175844803', '175844733', '184113435', '170592516', '175844834', '184526002', '175844861', '184364489', '184451122', '175845029', '184316344', '175844982', '175844731', '170592181', '170592297', '170592250', '170592120', '175845087', '184166308', '175844786', '184000642', '170591927', '170592058', '175844694', '184138917', '184483141', '184174892', '175844753', '184081075', '184390575', '175845039', '175844906', '184174416', '170592382', '170592313', '184505084', '175845007', '184393724', '175844689', '170592057', '175845028', '170592370', '184445304', '175845042', '170592126', '170592347', '170592157', '184515008', '175844979', '175844762', '170592115', '175845009', '175845018', '184226842', '184036090', '184557451', '175845101', '184593251', '184360081', '175844732', '175844801', '175844735', '184394549', '175845060', '170592158', '175844911', '184454589', '184289992', '184122047', '170592338', '170592009', '170592357', '184116005', '184504329', '184238562', '184376352', '170591976', '175844890', '184373841', '175844858', '170591958', '184096867', '170592036', '175844807', '175844855', '170592462', '175844782', '182926675', '184091238', '184586031', '170592306', '184428398', '170591912', '184410734', '184226526', '170591970', '175844701', '184313039', '170592038', '184306979', '170592019', '170591923', '170592269', '183812400', '184182546', '184421890', '175844853', '175845032', '183039678', '184192930', '175845052', '184213968', '184117491', '170591941', '184139054', '170591957', '170592421', '184452312', '170592536', '170592232', '184266670', '184145995', '184541271', '184392706', '170592315', '170591980', '170592276', '170592551', '175844968', '175844993', '170591975', '184064109', '170592206', '170592507', '175844751', '170592016', '170592447', '170592116', '175844716', '175844932', '170592295', '170592208', '175844996', '184261440', '175844777', '175844821', '170592069', '175844775', '184491299', '184253776', '170592522', '184337869', '184514490', '184454296', '184522707', '170592278', '170592464', '175844940', '184457125', '175844706', '170592429', '175844970', '170592095', '184512354', '170592228', '184408961', '170592483', '184102013', '175844690', '184527612', '183822703', '175845102', '175844770', '184023758', '170592519', '184198560', '170592368', '175844958', '170592279', '184303149', '170591984', '170592111', '183999839', '183977448', '175844974', '184524386', '170592037', '184114414', '170592207', '170592351', '184051798', '184141600', '175845043', '175845058', '170592029', '184267565', '170592021', '175844927', '184354723', '170592043', '170592246', '184047721', '184115531', '170592194', '170592241', '175844709', '170592227', '175844697', '175844914', '175845095', '184364995', '175844842', '184388540', '184198663', '170592335', '184205163', '170592321', '184036029', '184341475', '184193599', '184129898', '170592287', '170592451', '184371900', '184416832', '170592274', '184103317', '170592405', '184494712', '175844738', '184119299', '184074749', '175844763', '170592489', '184033349', '184388652', '184430227', '184519830', '175844724', '183326701', '175844986', '183361130', '184153163', '184114439', '175844812', '170592156', '184367919', '175844704', '184251867', '170592286', '184589715', '170592454', '184473438', '175845015', '184472064', '170592428', '170592458', '184393025', '170592531', '175844791', '170592062', '184358198', '170592112', '184367092', '175844913', '170592541', '170592190', '175845048', '175844964', '170592433', '184270962', '184115813', '184439351', '184344552', '184443561', '184558170', '175844778', '172800278', '175845107', '170592543', '184047251', '170592520', '170592174', '184015964', '184137732', '184132357', '170592401', '175845071', '170592554', '184168854', '175845050', '175845089', '170592512', '170592521', '170592186', '170592337', '175844943', '184425152', '184025227', '184134430', '184269922', '170592446', '184033529', '184221963', '175844727', '183526544', '175845096', '170592344', '170592138', '170592240', '184049916', '170592553', '175844919', '170592139', '170592034', '170592224', '175844756', '184047388', '170592146', '184385772', '184120099', '184507702', '184480890', '170592398', '175844839', '175845091', '170592478', '184148374', '184339982', '170592270', '184070711', '170592481', '175844811', '184458493', '184083909', '175844737', '184079218', '184380289', '170592505', '184435505', '170591937', '183517365', '170592155', '170591989', '184517525', '184374152', '170592020', '175844987', '184379596', '184006587', '175844804', '170592264', '170592431', '184386855', '184469263', '175844962', '175845045', '184516077', '184270370', '184149423', '170592006', '170592052', '184171032', '184360412', '170592482', '184415098', '184434998', '170591982', '170592233', '170592374', '170592526', '175844847', '184549045', '184388420', '184226902', '184291543', '184239442', '170592409', '175844951', '184248826', '184136447', '184343024', '175844815', '184170307', '184528323', '170592070', '170592182', '170592184', '175844806', '184244068', '170592257', '170592332', '183450322', '184428951', '184161258', '184553246', '184408559', '170592445', '170592305', '170592373', '175845065', '170592236', '184097609', '184465896', '170591994', '170591950', '175844707', '175844955', '184403542', '175844862', '170592277', '170591977', '170592142', '170592303', '184446322', '184187635', '184071060', '170592472', '184424846', '184391716', '184530608', '184511077', '183932009', '170592390', '175844900', '184383940', '184542461', '184170002', '184349547', '183961205', '184431922', '184629569', '184466558', '175845103', '170592176', '170591967', '184430374', '184227720', '184166575', '184254544', '184090199', '184387266', '170592461', '175845070', '184394177', '184386568', '170592097', '170592099', '170592047', '184451434', '170592336', '184141484', '175844710', '170592092', '184416099', '170592123', '170592432', '170592143', '175844684', '175845056', '184137752', '184195498', '176256618', '184001160', '170592292', '170592558', '184364051', '184209039', '184016596', '170592035', '184238782', '183998735', '184426077', '170592004', '170592362', '170591911', '170592149', '170592205', '170591932', '184218259', '170592281', '184383421', '170592455', '170592508', '184130702', '170592485', '170592135', '170592014', '170592162', '175844990', '184008775', '184136768', '170592131', '184528413', '170592515', '170592449', '170592088', '171874620', '175845014', '184528629', '175845033', '175844800', '175844810', '184132988', '184364524', '170592105', '170591978', '170591899', '170592217', '184168955', '184396132', '184421306', '184365135', '184221683', '184240693', '170592071', '184265867', '170591897', '184374272', '184180159', '184503920', '170592308', '170592391', '170592437', '170592040', '175844885', '170592456', '184470096', '184197499', '170592272', '184368011', '170592523', '184141054', '175844725', '170592384', '175844734', '175844708', '184198778', '184431075', '184185670', '184346051', '184419587', '170592141', '175845068', '175844714', '170592492', '184409961', '184364545', '184514289', '183117403', '172057171', '175845000', '170591933', '184443781', '184191190', '175844909', '184169457', '184437265', '170591955', '184101879', '184500451', '175845090', '170592423', '175844822', '184017693', '175845034', '184166970', '175844818', '184350641', '175844848', '170591973', '175844824', '175844742', '184524165', '170592160', '183387481', '183968108', '184218752', '175845023', '175844903', '184560019', '170592252', '170592144', '170592211', '175845047', '184430993', '184145059', '175845088', '170592243', '184118075', '175844768', '170592444', '184410391', '175844997', '184403271', '175845064', '175844796', '184165572', '184279904', '175844924', '175845005', '184461426', '184219989', '184365167', '175844921', '184220599', '175844749', '175845094', '183503277', '170592024', '175844889', '184525173', '175844831', '184132885', '175844817', '184430795', '170592063', '184489583', '170592103', '184164524', '170592064', '170592517', '175845027', '184420401', '170592007', '175844985', '184135881', '183943635', '183835691', '183860129', '184459560', '170591972', '170592022', '184519094', '175845104', '184557671', '175844755', '170592153', '170592301', '184444274', '184517992', '175844761', '184406152', '170592102', '184185392', '175845077', '184450444', '184209531', '184157544', '170591985']
que = [170591896,170591897,170591898,170591899,170591900,170591901,170591902,170591903,170591904,170591905,170591906,170591907,170591908,170591909,170591910,170591911,170591912,170591913,170591914,170591915,170591916,170591917,170591918,170591919,170591920,170591921,170591922,170591923,170591924,170591925,170591926,170591927,170591928,170591929,170591930,170591931,170591932,170591933,170591934,170591935,170591936,170591937,170591938,170591939,170591940,170591941,170591942,170591943,170591944,170591945,170591946,170591947,170591948,170591949,170591950,170591951,170591952,170591953,170591954,170591955,170591956,170591957,170591958,170591959,170591960,170591961,170591962,170591963,170591964,170591965,170591966,170591967,170591968,170591969,170591970,170591971,170591972,170591973,170591974,170591975,170591976,170591977,170591978,170591979,170591980,170591981,170591982,170591983,170591984,170591985,170591986,170591987,170591988,170591989,170591990,170591991,170591992,170591993,170591994,170591995,170591996,170591997,170591998,170591999,170592000,170592001,170592002,170592003,170592004,170592005,170592006,170592007,170592008,170592009,170592010,170592011,170592012,170592013,170592014,170592015,170592016,170592017,170592018,170592019,170592020,170592021,170592022,170592023,170592024,170592025,170592026,170592027,170592028,170592029,170592030,170592031,170592032,170592033,170592034,170592035,170592036,170592037,170592038,170592039,170592040,170592041,170592042,170592043,170592044,170592045,170592046,170592047,170592048,170592049,170592050,170592051,170592052,170592053,170592054,170592055,170592056,170592057,170592058,170592059,170592060,170592061,170592062,170592063,170592064,170592065,170592066,170592067,170592068,170592069,170592070,170592071,170592072,170592073,170592074,170592075,170592076,170592077,170592078,170592079,170592080,170592081,170592082,170592083,170592084,170592085,170592086,170592087,170592088,170592089,170592090,170592091,170592092,170592093,170592094,170592095,170592096,170592097,170592098,170592099,170592100,170592101,170592102,170592103,170592104,170592105,170592106,170592107,170592108,170592109,170592110,170592111,170592112,170592113,170592114,170592115,170592116,170592117,170592118,170592119,170592120,170592121,170592122,170592123,170592124,170592125,170592126,170592127,170592128,170592129,170592130,170592131,170592132,170592133,170592134,170592135,170592136,170592137,170592138,170592139,170592140,170592141,170592142,170592143,170592144,170592145,170592146,170592147,170592148,170592149,170592150,170592151,170592152,170592153,170592154,170592155,170592156,170592157,170592158,170592159,170592160,170592161,170592162,170592163,170592164,170592165,170592166,170592167,170592168,170592169,170592170,170592171,170592172,170592173,170592174,170592175,170592176,170592177,170592178,170592179,170592180,170592181,170592182,170592183,170592184,170592185,170592186,170592187,170592188,170592189,170592190,170592191,170592192,170592193,170592194,170592195,170592196,170592197,170592198,170592199,170592200,170592201,170592202,170592203,170592204,170592205,170592206,170592207,170592208,170592209,170592210,170592211,170592212,170592213,170592214,170592215,170592216,170592217,170592218,170592219,170592220,170592221,170592222,170592223,170592224,170592225,170592226,170592227,170592228,170592229,170592230,170592231,170592232,170592233,170592234,170592235,170592236,170592237,170592238,170592239,170592240,170592241,170592242,170592243,170592244,170592245,170592246,170592247,170592248,170592249,170592250,170592251,170592252,170592253,170592254,170592255,170592256,170592257,170592258,170592259,170592260,170592261,170592262,170592263,170592264,170592265,170592266,170592267,170592268,170592269,170592270,170592271,170592272,170592273,170592274,170592275,170592276,170592277,170592278,170592279,170592280,170592281,170592282,170592283,170592284,170592285,170592286,170592287,170592288,170592289,170592290,170592291,170592292,170592293,170592294,170592295,170592296,170592297,170592298,170592299,170592300,170592301,170592302,170592303,170592304,170592305,170592306,170592307,170592308,170592309,170592310,170592311,170592312,170592313,170592314,170592315,170592316,170592317,170592318,170592319,170592320,170592321,170592322,170592323,170592324,170592325,170592326,170592327,170592328,170592329,170592330,170592331,170592332,170592333,170592334,170592335,170592336,170592337,170592338,170592339,170592340,170592341,170592342,170592343,170592344,170592345,170592346,170592347,170592348,170592349,170592350,170592351,170592352,170592353,170592354,170592355,170592356,170592357,170592358,170592359,170592360,170592361,170592362,170592363,170592364,170592365,170592366,170592367,170592368,170592369,170592370,170592371,170592372,170592373,170592374,170592375,170592376,170592377,170592378,170592379,170592380,170592381,170592382,170592383,170592384,170592385,170592386,170592387,170592388,170592389,170592390,170592391,170592392,170592393,170592394,170592395,170592396,170592397,170592398,170592399,170592400,170592401,170592402,170592403,170592404,170592405,170592406,170592407,170592408,170592409,170592410,170592411,170592412,170592413,170592414,170592415,170592416,170592417,170592418,170592419,170592420,170592421,170592422,170592423,170592424,170592425,170592426,170592427,170592428,170592429,170592430,170592431,170592432,170592433,170592434,170592435,170592436,170592437,170592438,170592439,170592440,170592441,170592442,170592443,170592444,170592445,170592446,170592447,170592448,170592449,170592450,170592451,170592452,170592453,170592454,170592455,170592456,170592457,170592458,170592459,170592460,170592461,170592462,170592463,170592464,170592465,170592466,170592467,170592468,170592469,170592470,170592471,170592472,170592473,170592474,170592475,170592476,170592477,170592478,170592479,170592480,170592481,170592482,170592483,170592484,170592485,170592486,170592487,170592488,170592489,170592490,170592491,170592492,170592493,170592494,170592495,170592496,170592497,170592498,170592499,170592500,170592501,170592502,170592503,170592504,170592505,170592506,170592507,170592508,170592509,170592510,170592511,170592512,170592513,170592514,170592515,170592516,170592517,170592518,170592519,170592520,170592521,170592522,170592523,170592524,170592525,170592526,170592527,170592528,170592529,170592530,170592531,170592532,170592533,170592534,170592535,170592536,170592537,170592538,170592539,170592540,170592541,170592542,170592543,170592544,170592545,170592546,170592547,170592548,170592549,170592550,170592551,170592552,170592553,170592554,170592555,170592556,170592557,170592558,170592559,171716050,171874620,171990528,172057171,172289979,172461994,172800278,175844684,175844685,175844686,175844687,175844688,175844689,175844690,175844691,175844692,175844693,175844694,175844695,175844696,175844697,175844698,175844699,175844700,175844701,175844702,175844703,175844704,175844705,175844706,175844707,175844708,175844709,175844710,175844711,175844712,175844713,175844714,175844715,175844716,175844717,175844718,175844719,175844720,175844721,175844722,175844723,175844724,175844725,175844726,175844727,175844728,175844729,175844730,175844731,175844732,175844733,175844734,175844735,175844736,175844737,175844738,175844739,175844740,175844741,175844742,175844743,175844744,175844745,175844746,175844747,175844748,175844749,175844750,175844751,175844752,175844753,175844754,175844755,175844756,175844757,175844758,175844759,175844760,175844761,175844762,175844763,175844764,175844765,175844766,175844767,175844768,175844769,175844770,175844771,175844772,175844773,175844774,175844775,175844776,175844777,175844778,175844779,175844780,175844781,175844782,175844783,175844784,175844785,175844786,175844787,175844788,175844789,175844790,175844791,175844792,175844793,175844794,175844795,175844796,175844797,175844798,175844799,175844800,175844801,175844802,175844803,175844804,175844805,175844806,175844807,175844808,175844809,175844810,175844811,175844812,175844813,175844814,175844815,175844816,175844817,175844818,175844819,175844820,175844821,175844822,175844823,175844824,175844825,175844826,175844827,175844828,175844829,175844830,175844831,175844832,175844833,175844834,175844835,175844836,175844837,175844838,175844839,175844840,175844841,175844842,175844843,175844844,175844845,175844846,175844847,175844848,175844849,175844850,175844851,175844852,175844853,175844854,175844855,175844856,175844857,175844858,175844859,175844860,175844861,175844862,175844863,175844864,175844865,175844866,175844867,175844868,175844869,175844870,175844871,175844872,175844873,175844874,175844875,175844876,175844877,175844878,175844879,175844880,175844881,175844882,175844883,175844884,175844885,175844886,175844887,175844888,175844889,175844890,175844891,175844892,175844893,175844894,175844895,175844896,175844897,175844898,175844899,175844900,175844901,175844902,175844903,175844904,175844905,175844906,175844907,175844908,175844909,175844910,175844911,175844912,175844913,175844914,175844915,175844916,175844917,175844918,175844919,175844920,175844921,175844922,175844923,175844924,175844925,175844926,175844927,175844928,175844929,175844930,175844931,175844932,175844933,175844934,175844935,175844936,175844937,175844938,175844939,175844940,175844941,175844942,175844943,175844944,175844945,175844946,175844947,175844948,175844949,175844950,175844951,175844952,175844953,175844954,175844955,175844956,175844957,175844958,175844959,175844960,175844961,175844962,175844963,175844964,175844965,175844966,175844967,175844968,175844969,175844970,175844971,175844972,175844973,175844974,175844975,175844976,175844977,175844978,175844979,175844980,175844981,175844982,175844983,175844984,175844985,175844986,175844987,175844988,175844989,175844990,175844991,175844992,175844993,175844994,175844995,175844996,175844997,175844998,175844999,175845000,175845001,175845002,175845003,175845004,175845005,175845006,175845007,175845008,175845009,175845010,175845011,175845012,175845013,175845014,175845015,175845016,175845017,175845018,175845019,175845020,175845021,175845022,175845023,175845024,175845025,175845026,175845027,175845028,175845029,175845030,175845031,175845032,175845033,175845034,175845035,175845036,175845037,175845038,175845039,175845040,175845041,175845042,175845043,175845044,175845045,175845046,175845047,175845048,175845049,175845050,175845051,175845052,175845053,175845054,175845055,175845056,175845057,175845058,175845059,175845060,175845061,175845062,175845063,175845064,175845065,175845066,175845067,175845068,175845069,175845070,175845071,175845072,175845073,175845074,175845075,175845076,175845077,175845078,175845079,175845080,175845081,175845082,175845083,175845084,175845085,175845086,175845087,175845088,175845089,175845090,175845091,175845092,175845093,175845094,175845095,175845096,175845097,175845098,175845099,175845100,175845101,175845102,175845103,175845104,175845105,175845106,175845107,175845108,176256618,176414245,182488445,182758750,182926675,182944798,183039678,183057616,183066700,183089736,183117403,183135896,183286063,183326701,183343925,183349394,183361130,183363034,183371659,183386649,183387481,183432136,183450322,183461499,183469019,183476533,183503277,183517365,183526544,183527851,183538372,183622182,183625605,183645431,183652762,183812400,183822703,183828757,183835691,183860129,183861295,183872510,183896502,183897348,183911343,183914553,183921117,183932009,183932108,183934152,183936363,183939509,183940670,183943635,183953862,183961205,183962092,183963329,183968108,183968989,183969226,183969987,183977448,183993364,183993984,183994374,183998735,183998914,183999839,184000067,184000642,184001160,184005803,184006587,184008775,184013444,184015493,184015784,184015964,184016596,184016707,184017693,184021016,184021171,184021186,184023758,184025227,184027220,184029145,184030975,184031238,184033349,184033529,184034088,184034089,184036029,184036090,184036522,184037192,184039595,184039823,184046503,184047251,184047285,184047388,184047721,184047942,184049916,184051798,184053455,184055338,184055472,184055558,184055762,184059007,184059992,184060263,184061236,184061473,184061755,184061762,184064109,184065031,184065409,184065556,184067068,184067511,184069319,184070711,184071057,184071060,184071210,184071781,184073131,184074699,184074749,184077122,184077608,184078567,184079201,184079218,184080735,184081075,184082254,184082540,184083043,184083909,184083921,184085074,184087335,184089321,184090199,184091238,184091574,184093155,184095039,184096848,184096867,184097609,184097805,184098873,184100489,184101385,184101879,184102013,184103317,184106185,184108436,184108666,184109028,184109079,184109242,184109702,184110101,184110356,184110440,184110499,184111320,184113435,184114414,184114439,184115494,184115531,184115813,184116005,184117006,184117491,184118075,184119236,184119299,184120060,184120099,184120216,184120487,184122047,184123200,184124146,184125809,184125936,184126958,184129008,184129427,184129898,184130578,184130702,184131013,184131843,184132114,184132262,184132357,184132797,184132885,184132988,184133117,184134430,184135881,184136447,184136768,184137196,184137480,184137732,184137752,184138057,184138917,184139054,184139793,184140180,184141054,184141236,184141484,184141600,184142152,184142246,184143179,184143554,184144123,184144215,184144440,184145059,184145995,184146665,184146873,184146920,184147731,184148374,184149423,184149791,184150084,184150101,184150110,184150509,184151181,184151456,184151846,184152476,184153163,184153556,184154098,184154711,184155455,184155516,184156925,184157544,184157901,184159747,184161258,184162524,184163036,184163340,184163677,184164136,184164222,184164524,184164696,184165219,184165232,184165572,184166308,184166575,184166685,184166970,184167163,184167751,184168243,184168335,184168455,184168475,184168854,184168867,184168955,184169457,184169624,184170002,184170307,184171032,184171053,184171482,184171664,184171965,184172057,184172573,184173530,184174416,184174800,184174892,184176434,184179128,184179148,184180159,184181149,184181333,184182546,184182768,184184233,184184743,184185392,184185551,184185670,184186765,184187635,184187924,184188626,184189957,184190163,184190476,184190654,184190658,184190978,184191106,184191190,184191992,184192438,184192665,184192930,184193013,184193351,184193505,184193599,184194144,184195149,184195498,184195967,184196215,184196296,184196773,184197017,184197499,184197618,184197944,184198376,184198402,184198560,184198663,184198778,184199628,184201230,184203607,184204853,184205163,184205355,184205760,184207249,184207563,184208362,184209039,184209309,184209531,184209595,184209732,184209737,184210640,184211061,184212822,184213668,184213968,184214066,184215098,184215647,184215784,184216697,184216851,184217811,184218259,184218752,184218767,184219337,184219370,184219989,184220066,184220092,184220599,184221683,184221963,184226526,184226842,184226902,184226986,184227004,184227653,184227720,184229266,184231189,184231259,184232319,184233570,184235153,184235386,184236516,184238127,184238192,184238356,184238466,184238562,184238782,184239442,184240570,184240693,184240714,184244068,184244511,184246368,184247695,184248033,184248826,184248952,184249852,184250379,184251867,184253017,184253776,184254544,184255391,184255424,184256814,184257233,184257486,184258833,184260837,184261207,184261440,184265064,184265867,184266670,184267565,184269618,184269922,184270332,184270370,184270962,184271031,184271081,184271187,184271583,184274458,184278530,184279904,184281394,184282597,184285265,184289080,184289992,184291543,184293590,184294816,184295729,184296414,184297137,184300684,184301439,184302546,184303149,184305122,184305330,184306979,184307269,184308726,184311578,184311887,184313039,184316344,184316732,184320104,184320124,184324801,184325017,184325598,184326075,184328000,184329202,184329473,184330493,184330885,184331591,184332516,184333586,184335031,184337869,184339982,184340099,184340990,184341436,184341475,184342067,184342072,184342525,184343024,184343765,184344060,184344535,184344552,184344585,184344642,184345568,184346051,184347245,184349547,184350233,184350641,184351128,184351608,184351761,184351937,184352093,184352412,184353437,184354723,184357030,184357071,184358198,184360081,184360412,184361272,184361619,184362273,184362372,184363339,184363553,184363857,184364051,184364489,184364524,184364545,184364995,184365046,184365135,184365167,184366857,184366920,184367092,184367177,184367671,184367919,184368011,184368081,184368205,184369489,184371900,184372219,184373841,184374152,184374272,184374596,184374829,184376189,184376352,184377889,184379087,184379596,184380289,184380332,184380849,184381350,184381766,184382472,184383421,184383817,184383940,184385174,184385772,184385970,184386568,184386655,184386855,184387266,184387761,184387955,184387991,184388340,184388401,184388420,184388540,184388652,184390575,184390817,184391591,184391716,184391798,184392191,184392706,184393025,184393314,184393724,184393737,184394177,184394549,184395089,184395164,184396132,184396984,184397762,184398596,184398738,184399106,184399556,184400321,184400704,184400880,184403271,184403542,184405545,184406135,184406152,184406713,184408559,184408730,184408961,184408993,184409961,184410311,184410391,184410734,184410964,184411362,184411762,184411772,184411781,184411860,184412035,184412078,184412680,184412716,184412931,184413500,184414198,184414371,184415098,184416099,184416119,184416213,184416832,184416940,184417036,184419524,184419587,184420011,184420020,184420401,184420723,184420897,184421306,184421651,184421890,184422151,184422464,184423604,184424770,184424831,184424846,184425152,184426077,184426907,184427222,184427545,184428398,184428711,184428951,184429921,184430227,184430374,184430795,184430993,184431075,184431637,184431922,184432409,184432442,184432754,184433557,184433862,184434410,184434966,184434998,184435505,184436647,184437265,184437601,184437920,184439351,184439448,184440855,184441662,184441834,184442117,184442239,184442921,184443561,184443781,184444274,184444535,184444554,184444821,184445304,184446002,184446302,184446307,184446322,184447488,184447938,184448421,184448765,184448818,184450223,184450391,184450444,184451122,184451434,184452312,184453112,184454296,184454543,184454589,184455881,184456466,184456492,184457125,184457270,184457542,184458493,184459035,184459067,184459200,184459560,184460080,184460925,184461055,184461426,184462143,184464761,184465397,184465659,184465896,184466236,184466558,184466903,184467414,184468069,184469044,184469104,184469199,184469263,184470096,184470157,184470446,184470645,184472064,184473079,184473438,184473881,184474200,184474682,184475655,184479694,184480890,184480951,184482361,184483141,184483694,184483846,184484348,184484913,184485542,184486253,184489583,184490588,184491299,184491472,184491488,184491991,184494712,184494867,184498981,184499966,184500451,184500590,184501739,184502345,184502810,184503089,184503733,184503920,184504329,184504371,184505084,184506285,184506987,184507617,184507702,184507874,184508843,184510586,184510782,184511077,184511222,184511493,184512354,184512716,184514106,184514289,184514490,184514933,184515008,184515506,184515654,184516077,184516260,184517062,184517354,184517382,184517409,184517525,184517769,184517992,184518340,184518373,184519094,184519633,184519830,184520637,184520851,184521299,184522472,184522672,184522707,184523044,184523169,184523340,184523748,184524165,184524386,184525173,184525634,184525848,184526002,184526575,184526709,184527095,184527612,184528323,184528413,184528629,184528714,184530608,184530758,184531432,184532286,184532316,184532459,184532507,184532684,184533119,184533281,184533744,184534388,184534588,184534756,184537294,184537547,184538961,184539473,184540334,184541271,184541364,184541368,184541490,184542278,184542461,184543744,184543878,184544690,184544744,184544995,184546094,184546560,184546642,184547330,184548513,184549045,184550017,184550586,184550690,184552239,184553246,184553862,184554775,184555244,184557451,184557657,184557671,184558170,184558649,184559575,184560019,184560311,184561220,184562404,184565696,184565716,184566250,184566543,184567172,184567887,184568215,184568263,184569922,184572900,184580305,184585492,184586031,184589073,184589715,184590687,184591584,184593251,184594286,184595662,184603082,184612508,184613357,184629569,184631189,184631376,184632705,184635109,184635777,184638036

]
query = open('data/query.txt')
test = open('data/cols2.txt')


to_pass = []
m1 = MinHash(num_perm=128)
j = 0
for line in query:
    key = line.split('\t')[0]
    values = line.split('\t')[1].split(',')
    values[-1] = values[-1].replace('\n', '')
    values = set(values)
    j = len(values)

    for elem in values:
        m1.update(elem.encode('utf8'))


i = 0
for line in test:
    m = MinHash(num_perm=128)
    key = line.split('\t')[0]
    values = line.split('\t')[1].split(',')
    values[-1] = values[-1].replace('\n', '')
    values = set(values)
    for elem in values:
        m.update(elem.encode('utf8'))

    to_pass.append((str(i), m, len(values)))
    i += 1



# Create an LSH Ensemble index with threshold and number of partition
# settings.
lshensemble = MinHashLSHEnsemble(threshold=0.8, num_perm=128,
    num_part=32)

# Index takes an iterable of (key, minhash, size)
lshensemble.index(to_pass)

# Using m1 as the query, get an result iterator
print("Sets with containment > 0.8:")
for key in lshensemble.query(m1, j):
    print(key, m1.digest())


"""
set1 = set(["cat", "dog", "fish", "cow"])
set2 = set(["cat", "dog", "fish", "cow", "pig", "elephant", "lion", "tiger",
            "wolf", "bird", "human"])
set3 = set(["cat", "dog", "car", "van", "train", "plane", "ship", "submarine",
            "rocket", "bike", "scooter", "motorcyle", "SUV", "jet", "horse"])

query = set(
    [406786672, 406786673, 406786674, 406786675, 406786676, 406786677, 406786678, 406786679, 406786680, 406786681,
     406786682, 406786683, 406786684, 406786685, 406786686, 406786687, 406786688, 406786689, 406786690, 406786691,
     406786692, 406786693, 406786694, 406786695, 406786696, 406786697, 406786698, 406786699, 406786700, 406786701,
     406786702, 406786703, 406786704, 406786705, 406786706, 406786707, 406786708, 406786709, 406786710, 406786711,
     406786712, 406786713, 406786714, 406786715, 406786716, 406786717, 406786718, 406786719, 406786720, 406786721,
     406786722, 406786723, 406786724, 406786725, 406786726, 406786727, 406786728, 406786729, 406786730, 406786731,
     406786732, 406786733, 406786734, 406786735, 406786736, 406786737, 406786738, 406786739, 406786740, 406786741,
     406786742, 406786743, 406786744, 406786745, 406786746, 406786747, 406786748, 406786749, 406786750, 406786751,
     406786752, 406786753, 406786754, 406786755, 406786756, 406786757, 406786758, 406786759, 406786760, 406786761,
     406786762, 406786763, 406786764, 406786765, 406786766, 406786767, 406786768, 406786769, 406786770, 406786771,
     406786772, 406786773, 406786774, 406786775, 406786776, 406786777, 406786778, 406786779, 406786780, 406786781,
     406786782, 406786783, 406786784, 406786785, 406786786, 406786787, 406786788, 406786789, 406786790, 406786791,
     406786792, 406786793, 406786794, 406786795, 406786796, 406786797, 406786798, 406786799, 406786800, 406786801,
     406786802, 406786803, 406786804, 406786805, 406786806, 406786807, 406786808, 406786809, 406786810, 406786811,
     406786812, 406786813, 406786814, 406786815, 406786816, 406786817, 406786818, 406786819, 406786820, 406786821,
     406786822, 406786823, 406786824, 406786825, 406786826, 406786827, 406786828, 406786829, 406786830, 406786831,
     406786832, 406786833, 406786834, 406786835, 406786836, 406786837, 406786838, 406786839, 406786840, 406786841,
     406786842, 406786843, 406786844, 406786845, 406786846, 406786847, 406786848, 406786849, 406786850, 406786851,
     406786852, 406786853, 406786854, 406786855, 406786856, 406786857, 406786858, 406786859, 406786860, 406786861,
     406786862, 406786863, 406786864, 406786865, 406786866, 406786867, 406786868, 406786869, 406786870, 406786871,
     406786872, 406786873, 406786874, 406786875, 406786876, 406786877, 406786878, 406786879, 406786880, 406786881,
     406786882, 406786883, 406786884, 406786885, 406786886, 406786887, 406786888, 406786889, 406786890, 406786891,
     406786892, 406786893, 406786894, 406786895, 406786896, 406786897, 406786898, 406786899, 406786900, 406786901,
     406786902, 406786903, 406786904, 406786905, 406786906, 406786907, 406786908, 406786909, 406786910, 406786911,
     406786912, 406786913, 406786914, 406786915, 406786916, 406786917, 406786918, 406786919, 406786920, 406786921,
     406786922, 406786923, 406786924, 406786925, 406786926, 406786927, 406786928, 406786929, 406786930, 406786931,
     406786932, 406786933, 406786934, 406786935, 406786936, 406786937, 406786938, 406786939, 406786940, 406786941,
     151614787, 151614788, 151614789, 151614790, 151614791, 151614792, 151614793, 151614794, 151614795, 151614796,
     151614797, 151614798, 151614799, 151614800, 151614801, 151614802, 151614803, 151614804, 151614805, 357406289,
     357768336, 369332324, 438998212, 468684025, 486145597, 491669974, 493813512, 498567000, 499516784, 499877901,
     501217601, 501262161, 502428732, 513446324, 513457464, 520751905, 521571577, 523467379, 526358031, 526507197,
     527044658, 532733398, 534127099, 543083772, 543707251, 545282527, 545805238, 546267600, 547670091, 548282314,
     548356798, 548784460, 549238603, 550065148, 550895389, 550971880, 550991527, 551021183, 551072969, 551099181,
     551360027, 551720130, 551907162, 551931067, 551967024, 552324575, 552337735, 553133349, 553249122, 553285797,
     554268049, 554464245, 554615141, 555086429, 555264311, 555317886, 555368486, 555403661, 555423106, 555429703,
     555467607, 555467686, 555476002, 555517473, 555673087, 555765735, 555843172, 555867306, 556174003, 556231879,
     556236469, 556588978, 556608942, 556617636, 556628006, 556650298, 556716333, 556889161, 557084863, 557096029,
     557331368, 557334653, 557341521, 557553020, 557565473, 557565474, 557573129, 557617809, 557624128, 557643400,
     557671401, 557856586, 557861490, 558044798, 558071510, 558089021, 558131035, 558179364, 558201325, 558285608,
     558389101, 558496924, 558538205, 558569864, 558580885, 558603351, 558647359, 558649408, 558679788, 558721424,
     558725317, 558736908, 558747655, 558789593, 558806116, 558851343, 558851376, 559044534, 559063584, 559065207,
     559071137, 559107269, 559118407, 559119588, 559138623, 559158625, 559163794, 559211614, 559229349, 559261615,
     559270133, 559486264, 559489041, 559494552, 559518619, 559528567, 559562305, 559572095, 559583293, 559660368,
     560119736, 560119770, 560137412, 560138163, 560142906, 560161390, 560161470, 560183369, 560194108, 560198328,
     560202051, 560212419, 560221412, 560249303, 560268683, 560302035, 560302207, 560305561, 560327930, 560327931,
     560327932, 560327933, 560327934, 560327935, 560327936, 560327937, 560327938, 560327939, 560327940, 560327941,
     560327942, 560327943, 560327944, 560343958, 560345487, 560354589, 560356365, 560375694, 560388031, 560397081,
     560399387, 560399756, 560406145, 560408176, 560412990, 560415912, 560430967, 560445615, 560448681, 560478590,
     560500361, 560505546, 560508126, 560532826, 560538443, 560540051, 560544993, 560550971, 560552158, 560564439,
     560577331, 560586945, 560590725, 560620967, 560646078, 560653386, 560671931, 560680539, 560740514, 560841837,
     562263563, 562263621, 562272737, 562275609, 562277210, 562284675, 562286324, 562288122, 562289450, 562298910,
     562299944, 562301175, 562302675, 562303233, 562304603, 562305148, 562306634, 562306904, 562308809, 562309758,
     562309769, 562310342, 562310945, 562311081, 562311753, 562312130, 562314838, 562316490, 562316611, 562317218,
     562317304, 562317877, 562318500, 562319011, 562319037, 562319612, 562319653, 562319778])

test = set(
    [406786672, 406786673, 406786674, 406786675, 406786676, 406786677, 406786678, 406786679, 406786680, 406786681,
     406786682, 406786683, 406786684, 406786685, 406786686, 406786687, 406786688, 406786689, 406786690, 406786691,
     406786692, 406786693, 406786694, 406786695, 406786696, 406786697, 406786698, 406786699, 406786700, 406786701,
     406786702, 406786703, 406786704, 406786705, 406786706, 406786707, 406786708, 406786709, 406786710, 406786711,
     406786712, 406786713, 406786714, 406786715, 406786716, 406786717, 406786718, 406786719, 406786720, 406786721,
     406786722, 406786723, 406786724, 406786725, 406786726, 406786727, 406786728, 406786729, 406786730, 406786731,
     406786732, 406786733, 406786734, 406786735, 406786736, 406786737, 406786738, 406786739, 406786740, 406786741,
     406786742, 406786743, 406786744, 406786745, 406786746, 406786747, 406786748, 406786749, 406786750, 406786751,
     406786752, 406786753, 406786754, 406786755, 406786756, 406786757, 406786758, 406786759, 406786760, 406786761,
     406786762, 406786763, 406786764, 406786765, 406786766, 406786767, 406786768, 406786769, 406786770, 406786771,
     406786772, 406786773, 406786774, 406786775, 406786776, 406786777, 406786778, 406786779, 406786780, 406786781,
     406786782, 406786783, 406786784, 406786785, 406786786, 406786787, 406786788, 406786789, 406786790, 406786791,
     406786792, 406786793, 406786794, 406786795, 406786796, 406786797, 406786798, 406786799, 406786800, 406786801,
     406786802, 406786803, 406786804, 406786805, 406786806, 406786807, 406786808, 406786809, 406786810, 406786811,
     406786812, 406786813, 406786814, 406786815, 406786816, 406786817, 406786818, 406786819, 406786820, 406786821,
     406786822, 406786823, 406786824, 406786825, 406786826, 406786827, 406786828, 406786829, 406786830, 406786831,
     406786832, 406786833, 406786834, 406786835, 406786836, 406786837, 406786838, 406786839, 406786840, 406786841,
     406786842, 406786843, 406786844, 406786845, 406786846, 406786847, 406786848, 406786849, 406786850, 406786851,
     406786852, 406786853, 406786854, 406786855, 406786856, 406786857, 406786858, 406786859, 406786860, 406786861,
     406786862, 406786863, 406786864, 406786865, 406786866, 406786867, 406786868, 406786869, 406786870, 406786871,
     406786872, 406786873, 406786874, 406786875, 406786876, 406786877, 406786878, 406786879, 406786880, 406786881,
     406786882, 406786883, 406786884, 406786885, 406786886, 406786887, 406786888, 406786889, 406786890, 406786891,
     406786892, 406786893, 406786894, 406786895, 406786896, 406786897, 406786898, 406786899, 406786900, 406786901,
     406786902, 406786903, 406786904, 406786905, 406786906, 406786907, 406786908, 406786909, 406786910, 406786911,
     406786912, 406786913, 406786914, 406786915, 406786916, 406786917, 406786918, 406786919, 406786920, 406786921,
     406786922, 406786923, 406786924, 406786925, 406786926, 406786927, 406786928, 406786929, 406786930, 406786931,
     406786932, 406786933, 406786934, 406786935, 406786936, 406786937, 406786938, 406786939, 406786940, 406786941])

# Create MinHash objects
m1 = MinHash(num_perm=128)
m2 = MinHash(num_perm=128)
m3 = MinHash(num_perm=128)
for d in query:
    m1.update(str(d).encode('utf8'))
for d in test:
    m2.update(str(d).encode('utf8'))
for d in set3:
    m3.update(str(d).encode('utf8'))

print(m1.copy())

dig = str(m1.digest())
print(dig)


# Create an LSH Ensemble index with threshold and number of partition
# settings.
lshensemble = MinHashLSHEnsemble(threshold=0.8, num_perm=128,
    num_part=32)

# Index takes an iterable of (key, minhash, size)
lshensemble.index([("m2", m2, len(test))])

# Check for membership using the key
print("m2" in lshensemble, len(test))
print("m3" in lshensemble, len(query))

# Using m1 as the query, get an result iterator
print("Sets with containment > 0.8:")
for key in lshensemble.query(m1, len(query)):
    print(key)
"""
"""
def approx(query):
    pass
def sim_search(index, query, s):
    pass
def containment_search(index, minhash, thresh):
    cardinalities = []
    query = []
    l = min(cardinalities)
    u = max(cardinalities)
    q = approx(query)
    s = None
    candidates = sim_search(index, query, s)
    return candidates
def main():
    start = datetime.now()
    findspark.init()
    spark = SparkSession.builder.appName("atcs").getOrCreate()

    data = 'hdfs://localhost:9000/user/ebt/input/cols2.txt'
    data2 = 'hdfs://localhost:9000/user/ebt/input/cols2.txt'
    df = spark.read.csv(data, sep='\t', header=False)\
        .withColumnRenamed('_c0', 'key1')\
        .withColumnRenamed('_c1', 'col1')
    df.show(2)
    df2 = spark.read.csv(data2, sep='\t', header=None)\
        .withColumnRenamed('_c0', 'key2')\
        .withColumnRenamed('_c1', 'col2')
    df3 = df.crossJoin(df2)



    print('total time: ' + str(datetime.now() - start))

#main()
"""
